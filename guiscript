-- ImprovedBaChuUI.lua
local Library = {}
Library.__index = Library

function Library.CreateWindow(config)
    local title = config.Title or "UI Hub"
    local logo = config.LogoImage -- url decal
    local desc = config.Description or ""
    local self = setmetatable({}, Library)

    local sg = Instance.new("ScreenGui")
    sg.Name = "BaChuUI"; sg.Parent = game:GetService("CoreGui")
    self.sg = sg

    -- Main transparent rounded frame
    local Frame = Instance.new("Frame", sg)
    Frame.AnchorPoint = Vector2.new(0.5,0.5)
    Frame.Position = UDim2.new(0.5,0,0.5,0)
    Frame.Size = UDim2.new(0,480,0,320)
    Frame.BackgroundColor3 = Color3.fromRGB(20,20,20)
    Frame.BackgroundTransparency = 0.4
    Frame.ClipsDescendants = true
    Frame.AutoLocalize = false
    self.Frame = Frame

    -- Corner rounding
    local UICorner = Instance.new("UICorner", Frame)
    UICorner.CornerRadius = UDim.new(0,12)

    -- Header bar
    local Header = Instance.new("Frame", Frame)
    Header.Size = UDim2.new(1,0,0,32)
    Header.BackgroundTransparency = 1

    local lbl = Instance.new("TextLabel", Header)
    lbl.Text = title
    lbl.Font = Enum.Font.GothamSemibold
    lbl.TextSize = 16
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1
    lbl.Position = UDim2.new(0,40,0,0)
    lbl.Size = UDim2.new(0.5,0,1,0)

    if logo then
        local img = Instance.new("ImageLabel", Header)
        img.Image = logo
        img.Size = UDim2.new(0,28,0,28)
        img.Position = UDim2.new(0,4,0,2)
        img.BackgroundTransparency = 1
        Instance.new("UICorner", img).CornerRadius = UDim.new(0,6)
    end

    local descLabel = Instance.new("TextLabel", Frame)
    descLabel.Text = desc
    descLabel.TextSize = 14
    descLabel.Font = Enum.Font.Gotham
    descLabel.TextColor3 = Color3.new(1,1,1)
    descLabel.BackgroundTransparency = 1
    descLabel.Position = UDim2.new(0,8,0,36)
    descLabel.Size = UDim2.new(1, -16, 0, 20)

    -- Control buttons
    local ctrlFrame = Instance.new("Frame", Header)
    ctrlFrame.Size = UDim2.new(0,96,1,0)
    ctrlFrame.Position = UDim2.new(1,-96,0,0)
    ctrlFrame.BackgroundTransparency = 1

    local btnStyle = {Size = UDim2.new(0,28,0,28), Font = Enum.Font.GothamSemibold, TextSize = 16}

    local function makeBtn(symbol, pos, onClick)
        local b = Instance.new("TextButton", ctrlFrame)
        b.Text = symbol
        b.Size = btnStyle.Size
        b.Position = UDim2.new(0,pos,0,2)
        b.Font = btnStyle.Font
        b.TextSize = btnStyle.TextSize
        b.BackgroundTransparency = 0.5
        b.TextColor3 = Color3.new(1,1,1)
        Instance.new("UICorner", b).CornerRadius = UDim.new(0,4)
        b.MouseButton1Click:Connect(onClick)
    end

    makeBtn("–", 0, function() Frame.Visible = false end)
    makeBtn("□", 32, function() -- toggle size
        Frame.Size = Frame.Size == UDim2.new(0,480,0,320) and UDim2.new(0,600,0,400) or UDim2.new(0,480,0,320)
    end)
    makeBtn("✕", 64, function() sg:Destroy() end)

    -- Sidebar
    local side = Instance.new("Frame", Frame)
    side.Position = UDim2.new(0,0,0,64); side.Size = UDim2.new(0,112,1,-64)
    side.BackgroundTransparency = 1
    self.Sidebar = side

    -- Content holder
    local content = Instance.new("Frame", Frame)
    content.Position = UDim2.new(0,112,0,64); content.Size = UDim2.new(1,-112,1,-64)
    content.BackgroundTransparency = 1
    self.Content = content

    self.Tabs = {} ; self.SelectedTab = nil
    return self
end

function Library:AddTab(name)
    local tab = {}
    local idx = #self.Sidebar:GetChildren()
    local btn = Instance.new("TextButton", self.Sidebar)
    btn.Text = name ; btn.BackgroundTransparency = 0.6
    btn.Size = UDim2.new(1,0,0,32); btn.Position = UDim2.new(0,0,0, idx*36)
    btn.Font = Enum.Font.Gotham; btn.TextSize = 14
    btn.TextColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

    local pane = Instance.new("Frame", self.Content)
    pane.Size = UDim2.new(1,1,1,1); pane.BackgroundTransparency = 1; pane.Visible = false
    pane.LayoutOrder = idx
    self.Tabs[name] = pane

    btn.MouseButton1Click:Connect(function()
        for n,t in pairs(self.Tabs) do t.Visible = (n == name) end
    end)
    -- auto select first
    if not self.SelectedTab then btn:CaptureFocus(); btn.MouseButton1Click:Fire(); self.SelectedTab = name end

    function tab:Switch(text, default, cb) -- toggle style
        local ctr = Instance.new("Frame", pane); ctr.Size = UDim2.new(1,-16,0,28)
        ctr.Position = UDim2.new(0,8,0,#pane:GetChildren()*32)
        local lbl = Instance.new("TextLabel", ctr); lbl.Text=text; lbl.Size=UDim2.new(0.7,0,1,0); lbl.BackgroundTransparency=1; lbl.Font=Enum.Font.Gotham; lbl.TextSize=14; lbl.TextColor3=Color3.new(1,1,1)
        local sw = Instance.new("TextButton", ctr); sw.Text=default and "ON" or "OFF"
        sw.Size = UDim2.new(0.3,-4,1,0); sw.Position=UDim2.new(0.7,4,0,0)
        sw.BackgroundColor3=default and Color3.fromRGB(0,200,0) or Color3.fromRGB(200,0,0)
        Instance.new("UICorner", sw).CornerRadius=UDim.new(0,4)
        local state = default
        sw.MouseButton1Click:Connect(function()
            state = not state; sw.Text=state and "ON" or "OFF"
            sw.BackgroundColor3=state and Color3.fromRGB(0,200,0) or Color3.fromRGB(200,0,0)
            cb(state)
        end)
    end

    function tab:Button(text, cb)
        local b = Instance.new("TextButton", pane)
        b.Text = text; b.Size = UDim2.new(1,-16,0,28)
        b.Position = UDim2.new(0,8,0,#pane:GetChildren()*32)
        b.Font = Enum.Font.Gotham; b.TextSize = 14; b.TextColor3 = Color3.new(1,1,1)
        b.BackgroundTransparency=0.6
        Instance.new("UICorner", b).CornerRadius = UDim.new(0,4)
        b.MouseButton1Click:Connect(cb)
    end

    self.Tabs[name] = pane
    return tab
end

function Library:Destroy() self.sg:Destroy() end
return Library
